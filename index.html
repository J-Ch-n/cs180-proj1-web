<!-- Referenced https://www.freecodecamp.org/news/basic-html5-template-boilerplate-code-example/ for boilerplate. -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CS180 Project 1 - Images of the Russian Empire:
      Colorizing the Prokudin-Gorskii Photo Collection</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1> CS180 Project 1 - Images of the Russian Empire:
      Colorizing the Prokudin-Gorskii Photo Collection</h1>
    <h2> Algorithms </h2>
    
    <h3> Exhaustive Search</h3>
    
    <p> First I implemented exhaustive search for low resolution images. I chose one color as the base layer and attempted to 
      align the other two layers on the base layer one at a time. To align the layer pairs, I first experimented with a naive exhaustive search without
      any preprocessing. I simply looped over every single shifts in the x and y directions, calculated a metric, and kept the shift that created the optimal
      metric. I tried both euclidean distance and normalized cross correlation(NCC). For euclidean distance, I kept the shift that generated the lowest distance, whereas for 
      NCC, I kepted the one with the maximum score. This was because a set of similar images would produce a lower distance and a higher correlation. However, this was not
      enough to successfully align the layers, so I tried to preprocess each image layer. Since NCC performed slightly better than euclidean distance, I used 
      NCC for all images. At first, I only add a sobel edge detector to allow my algorithm to only focus on the macro-features and not 
      color and lighting differences. However, this only improved the alignment by a small margin. After observing the preprocessed images, I discovered that each layer had uneven edges that 
      can dominate and mislead my algorithm. Thus, I cropped each layer 20% of the image height/width in each direction from each side. This update finally properly aligned the image pairs. Using this 
      finalized algorithm, I was able to stack the aligned layers together to produce a visually pleasing colored image.
    </p>
    
    <h3> Image Pyramid</h3>
    
    <p> While the exhaustive search approach could easily handle low resolution images, it failed to process the high resolution (tif) files efficiently. Enters the image pyramid. Here, I implemented a recursive
      search from the lowest resolution all the way to the highest resolution (halfing the image dimensions each layer), updating the optimal shift while keeping the search window small. The recursive structures starts from the highest resolution. When the recursive 
      calls hit a base case where the size is less than equal to 10 by 10 pixels, the function would find an optimal shift using the exhaustive search function outlined above. After the base layer returns the optimal shift, the layers 
      above will recursively update the optimal shifts within a 10 by 10 window centered at the previous optimal shift. The reason why I used a 10 by 10 window throughout was because I needed to exhaustively search the base case image. Otherwise, 
      the algorithm may not be able to find the optimal shift in the image with the lowest quality. After the recursive stack finishes, the returned value would be the optimal shift for the original image. I originally tried to use 30 by 30 as the smallest window size 
      each time, but my program was too slow, so I changed to the current configuration.
    </p>
    <hr />
    
    <!-- https://www.tutorialspoint.com/how-to-set-caption-for-an-image-using-html#:~:text=HTML%20allows%20setting%20a%20caption,to%20define%20the%20caption%20text. -->
    <h2> Select Images</h2>
    <div class="image_container">
      <div class="image_1 image">
        <figure> 
          <img src="./out_path/cathedral.jpg", width="300">
          <figcaption class="caption"> Cathedral </figcaption>
        </figure>
      </div>
      <div class="image_2 image">
        <figure> 
          <img src="./out_path/monastery.jpg", width="300">
          <figcaption class="caption"> Monastery </figcaption>
        </figure>
      </div>
      <div class="image_3 image">
        <figure> 
          <img src="./out_path/tobolsk.jpg", width="300">
          <figcaption class="caption"> Tobolsk </figcaption>
        </figure>
      </div>
      <div class="image_4 image">
        <figure> 
          <img src="./out_path/harvesters.jpg", width="300">
          <figcaption class="caption"> Harvesters </figcaption>
        </figure>
      </div>
      <div class="image_5 image">
        <figure> 
          <img src="./out_path/sculpture.jpg", width="300">
          <figcaption class="caption"> Sculpture </figcaption>
        </figure>
      </div>
      <div class="image_6 image">
        <figure> 
          <img src="./out_path/three_generations.jpg", width="300">
          <figcaption class="caption"> Three Generations </figcaption>
        </figure>
      </div>
    </div>
  </body>
</html>